
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Case Tree_analyses</title>
    
    <meta name="author" content="Caitlin Rivers">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Epipy</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Documentation</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/mers.html">MERS-CoV example</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Case Tree_analyses <small>Case tree plot analyses</small></h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>07 May 2015</span>
    </div>
    <div class="content">
      
<p><a href="http://cmrivers.github.io/epipy/plots/2014/02/01/case-tree-plot/">Case tree plots</a> are useful for visualizing and analyzing small clusters of zoonotic disease with limited human to human potential. Examples include MERS-CoV and Ebola.</p>

<h2 id="basic-reproduction-number">Basic reproduction number</h2>

<p><strong>What is the basic reproduction number?</strong></p>

<p>The <a href="http://en.wikipedia.org/wiki/Basic_reproduction_number">basic reproduction number</a>,
also called R0, is the average number of secondary cases each case produces
in a fully susceptible population. In order for an outbreak to sustain itself,
R0 must be greater than 1. The higher the R0, the more infectious the disease.</p>

<p>For most outbreaks, R0 must be estimated. Case tree plots have the advantage
of showing the exact number of secondary cases per source case.</p>

<p><strong>Example</strong></p>

<p>For this example, we’ll use data from the MERS-CoV packaged with epipy.
You may need to change the path below. To start, first build out the graph.
Then simply call reproduction_number(), which will return a series object,
and a histogram of the R0s. The function has an option to exclude index cases
(index_cases=False), which is useful if you want to calculate the human
to human reproduction number without considering zoonotically acquired cases.</p>

<pre><code>import epipy
import pandas as pd

data = epipy.generate_example_data(cluster_size=10, outbreak_len=100, clusters=10, gen_time=5)
</code></pre>

<p>If you’re working with case tree plots, you can get the graph from the case_tree_plot function.</p>

<pre><code>G, fig, ax = epipy.case_tree_plot(data, cluster_id='Cluster', case_id='ID', date_col='Date', color='Cluster', gen_mean=5, gen_sd=2)
</code></pre>

<p><img src="https://github.com/cmrivers/epipy/blob/master/figs/example_case_tree.png?raw=true" alt="Example case tree" /></p>

<p>But if you want don’t want to produce the plot, you can get the same thing using the build_graph function.</p>

<pre><code>G = epipy.build_graph(data, 'Cluster', 'ID', 'Date', 'Cluster', 5, 2)
</code></pre>

<p>You can then use the graph to assess the reproduction number. You may choose whether or not to include the index cases in the calculation.</p>

<pre><code>R, fig, ax = epipy.reproduction_number(G, index_cases=True, plot=True)
</code></pre>

<p>The series object, R in the above example, can be manipulated further.</p>

<pre><code>print R.describe()
</code></pre>

<p>The R variable returns:</p>

<pre><code>count    101.000000
mean       1.000000
std        1.296148
min        0.000000
25%        0.000000
50%        0.000000
75%        2.000000
max        5.000000
dtype: float64
</code></pre>

<p>And the figure returns:</p>

<p><img src="https://github.com/cmrivers/epipy/blob/master/figs/r0_hist.png?raw=true" alt="Histogram of reproduction numbers" /></p>

<h2 id="generation-analyses">Generation analyses</h2>

<p>Epidemiologists may also be interested in how the disease changes from
one generation to the next. Are cases acquired from animals more severe
than human acquired cases? Does severity decrease as the disease passes
from person to person? Are index cases more likely to be men?
The generation_analysis() function returns a table of case attributes by
generation, as well as an optional bar graph.</p>

<p><strong>Example</strong></p>

<pre><code>fig, ax, table = fig, ax, table = epipy.generation_analysis(G, attribute='sex')
</code></pre>

<p>The table variable returns:</p>

<pre><code>sex by generation
sex         Female  Male  All
generation
0                3     7   10
1                3     8   11
2                5     8   13
3                5     7   12
4                9     5   14
5                5     7   12
6                7     3   10
7                4     3    7
8                0     3    3
9                1     0    1
All             42    51   93
</code></pre>

<p>And the figure returns a histogram of number of cases at each generation, by attribute:</p>

<p><img src="https://github.com/cmrivers/epipy/blob/master/figs/example_data_generation_hist.png?raw=true" alt="Health status by generation" /></p>

<p><a href="http://cmrivers.github.io/epipy/categories.html">Back to documentation</a></p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#analyses-ref">
    		analyses <span>3</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/mers.html#analyses-ref">analyses <span>3</span></a></li>
     
    	<li><a href="/mers.html#case tree-ref">case tree <span>2</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/plots/2014/02/01/epicurves" title="Epicurves">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/analyses/2015/05/07/summarystats" title="Summarystats">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    
  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2015 Caitlin Rivers
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

